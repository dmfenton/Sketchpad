@import 'tailwindcss';

/* Drawing Agent Web - Tailwind 4 Theme */
@theme {
  /* Colors */
  --color-bg-primary: #1a1a2e;
  --color-bg-secondary: #16213e;
  --color-bg-tertiary: #0f3460;
  --color-accent: #e94560;
  --color-accent-dim: #a83248;
  --color-text-primary: #eee;
  --color-text-secondary: #aaa;
  --color-text-muted: #666;
  --color-border: #333;
  --color-success: #4ade80;
  --color-warning: #fbbf24;
  --color-error: #ef4444;
}

/* Legacy CSS variables for existing components */
:root {
  --bg-primary: theme(--color-bg-primary);
  --bg-secondary: theme(--color-bg-secondary);
  --bg-tertiary: theme(--color-bg-tertiary);
  --accent: theme(--color-accent);
  --accent-dim: theme(--color-accent-dim);
  --text-primary: theme(--color-text-primary);
  --text-secondary: theme(--color-text-secondary);
  --text-muted: theme(--color-text-muted);
  --border: theme(--color-border);
  --success: theme(--color-success);
  --warning: theme(--color-warning);
  --error: theme(--color-error);
}

body {
  @apply bg-bg-primary text-text-primary;
}

/* Layout */
.app {
  display: grid;
  grid-template-columns: 1fr 400px;
  grid-template-rows: auto auto 1fr;
  height: 100vh;
  gap: 1px;
  @apply bg-border;
}

/* Responsive layout */
@media (max-width: 1023px) {
  .app {
    grid-template-columns: 1fr 300px;
  }
}

@media (max-width: 767px) {
  .app {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto 1fr auto;
  }

  .app.show-messages .canvas-container,
  .app.show-debug .canvas-container {
    display: none;
  }

  .app:not(.show-messages):not(.show-debug) .right-panel {
    display: none;
  }

  .right-panel {
    grid-row: 3;
  }
}

.header {
  grid-column: 1 / -1;
  @apply bg-bg-secondary px-5 py-2 flex items-center justify-between relative;
}

.header-left {
  @apply flex items-center gap-2;
}

.header-center {
  @apply absolute left-1/2 -translate-x-1/2;
}

.header-right {
  @apply flex items-center gap-3;
}

.header h1 {
  @apply text-base font-semibold m-0;
}

.piece-count {
  @apply text-sm text-text-secondary;
}

.status-pill {
  @apply px-3 py-1 rounded-xl text-xs font-medium uppercase;
}

.status-pill.idle {
  @apply bg-text-muted;
}
.status-pill.thinking {
  @apply bg-accent;
}
.status-pill.executing {
  @apply bg-warning text-black;
}
.status-pill.drawing {
  @apply bg-success text-black;
}
.status-pill.paused {
  @apply bg-text-secondary text-black;
}
.status-pill.error {
  @apply bg-error;
}

/* Canvas area */
.canvas-container {
  @apply bg-bg-primary flex items-center justify-center p-5 overflow-hidden relative;
  min-height: 0;
}

.canvas-wrapper {
  @apply bg-white rounded-lg overflow-hidden relative w-full h-full;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
  aspect-ratio: 4 / 3;
  max-width: 100%;
  max-height: 100%;
}

.canvas-wrapper svg {
  @apply block w-full h-full;
}

/* Right panel */
.right-panel {
  @apply flex flex-col bg-bg-secondary overflow-hidden;
  min-height: 0;
}

/* Message stream container */
.message-stream-container {
  @apply flex-1 flex flex-col overflow-hidden;
  min-height: 200px;
}

.message-stream {
  @apply flex-1 overflow-y-auto p-4;
  min-height: 0;
}

.message {
  @apply p-3 mb-2 rounded-lg text-sm leading-relaxed bg-bg-tertiary;
}

.message.thinking {
  @apply border-l-[3px] border-accent;
}

.message.iteration {
  @apply text-center bg-transparent text-text-secondary text-xs p-1;
}

.message.code_execution {
  @apply font-mono text-[13px] border-l-[3px] border-warning;
}

.message.error {
  @apply border-l-[3px] border-error bg-error/10;
}

.message.piece_complete {
  @apply border-l-[3px] border-success bg-success/10;
}

.message .streaming-indicator {
  @apply inline-block w-2 h-2 bg-accent rounded-full ml-1.5 animate-pulse;
}

/* Debug panel */
.debug-panel {
  @apply border-t border-border flex flex-col overflow-hidden shrink-0;
  height: 250px;
  min-height: 250px;
}

@media (max-width: 767px) {
  .debug-panel {
    height: auto;
    min-height: 0;
    flex: 1;
  }
}

.debug-tabs {
  @apply flex bg-bg-primary;
}

.debug-tab {
  @apply px-4 py-2 text-xs border-none bg-transparent text-text-secondary cursor-pointer border-b-2 border-transparent;
}

.debug-tab.active {
  @apply text-accent border-accent;
}

.debug-content {
  @apply flex-1 overflow-y-auto p-3 text-xs font-mono bg-bg-primary;
}

.debug-content pre {
  @apply whitespace-pre-wrap break-all;
}

/* Action bar */
.action-bar {
  grid-column: 1 / -1;
  @apply bg-bg-secondary px-5 py-3 flex items-center gap-3;
}

@media (max-width: 767px) {
  .action-bar {
    @apply flex-wrap justify-center px-3 py-2;
  }
}

.action-bar-left {
  @apply flex items-center gap-2;
}

.action-bar-center {
  @apply flex-1 flex items-center justify-center gap-2 mx-auto;
  max-width: 600px;
}

@media (max-width: 767px) {
  .action-bar-center {
    @apply w-full order-first;
  }
}

.action-bar-right {
  @apply flex items-center gap-2;
}

.action-bar button {
  @apply px-4 py-2 rounded-md border-none text-sm font-medium cursor-pointer transition-colors min-h-[44px];
}

.action-bar button.primary {
  @apply bg-accent text-white hover:bg-accent-dim disabled:bg-text-muted disabled:cursor-not-allowed;
}

.action-bar button.secondary {
  @apply bg-bg-tertiary text-text-primary hover:bg-[#1a4a80];
}

.action-bar button.start-btn {
  @apply px-8 py-2.5 text-base;
}

.action-bar button.pause-btn {
  @apply px-3 py-2;
}

.action-bar button.icon-btn {
  @apply p-2 bg-transparent border border-border rounded-md hover:bg-bg-tertiary;
}

.action-bar button.icon-btn.active {
  @apply bg-accent border-accent;
}

.action-bar button.icon-btn .icon {
  @apply text-base;
}

.action-bar button.text-btn {
  @apply bg-transparent text-text-secondary px-3 py-2 hover:text-text-primary hover:bg-bg-tertiary;
}

.action-bar input {
  @apply flex-1 px-3 py-2 rounded-md border border-border bg-bg-primary text-text-primary text-sm min-w-[200px] min-h-[44px];
}

@media (max-width: 767px) {
  .action-bar input {
    @apply min-w-0 w-full;
  }
}

.action-bar input::placeholder {
  @apply text-text-muted;
}

/* Modal */
.modal-overlay {
  @apply fixed inset-0 bg-black/70 flex items-center justify-center z-[1000];
}

.modal {
  @apply bg-bg-secondary rounded-xl p-6 w-[90%] max-w-[450px];
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

.modal h3 {
  @apply m-0 mb-2 text-lg font-semibold;
}

.modal p {
  @apply m-0 mb-4 text-text-secondary text-sm;
}

.modal input {
  @apply w-full p-3 rounded-md border border-border bg-bg-primary text-text-primary text-sm box-border focus:outline-none focus:border-accent;
}

.modal input::placeholder {
  @apply text-text-muted;
}

.modal-actions {
  @apply flex justify-end gap-3 mt-5;
}

.modal-actions button {
  @apply px-5 py-2.5 rounded-md border-none text-sm font-medium cursor-pointer;
}

.modal-actions button.primary {
  @apply bg-accent text-white hover:bg-accent-dim;
}

.modal-actions button.secondary {
  @apply bg-bg-tertiary text-text-primary hover:bg-[#1a4a80];
}

/* Connection status */
.connection-status {
  @apply flex items-center gap-1.5 text-xs text-text-secondary;
}

.connection-dot {
  @apply w-2 h-2 rounded-full;
}

.connection-dot.connected {
  @apply bg-success;
}
.connection-dot.connecting {
  @apply bg-warning;
}
.connection-dot.disconnected {
  @apply bg-error;
}

/* Mobile navigation */
.mobile-nav {
  @apply hidden;
}

@media (max-width: 767px) {
  .mobile-nav {
    @apply fixed bottom-0 left-0 right-0 bg-bg-secondary border-t border-border flex z-50;
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .mobile-nav button {
    @apply flex-1 py-3 text-xs text-text-secondary bg-transparent border-none cursor-pointer flex flex-col items-center gap-1;
  }

  .mobile-nav button.active {
    @apply text-accent;
  }

  .mobile-nav button .icon {
    @apply text-lg;
  }

  /* Add padding at bottom for mobile nav */
  .app {
    padding-bottom: calc(60px + env(safe-area-inset-bottom, 0));
  }
}

/* Scrollbar styling */
::-webkit-scrollbar {
  @apply w-2;
}

::-webkit-scrollbar-track {
  @apply bg-bg-primary;
}

::-webkit-scrollbar-thumb {
  @apply bg-border rounded;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-text-muted;
}

/* Touch-friendly utilities */
@utility touch-target {
  min-height: 44px;
  min-width: 44px;
}
